---
layout: post
title: "4. 렌더링 파이프라인(3)"
date: 2018-12-19 19:55:00
description: 나머지 부분
share: false
comments: true
tags: 
 - directX
---

테셀레이션(tessellation) 단계
======
**테셀레이션** : 한 메시의 삼각형들을 더 잘게 쪼개서 새로운 삼각형들을 만드는 과정. 좀 더 세밀한 메시를 만든다.
- LOD(level-of-detail) 구현가능. 저다각형 메시로 물리 연산을 수행하고 고다각형 메시를 렌더링에 사용해 계산량을 줄일 수 있다.  
Direct3D 11에서 새로 추가됨.  
테셀레이션은 생략 가능하다.

- - -

기하 셰이더(geometry shader, GS) 단계
======
하나의 온전한 기본도형을 입력받아 임의로 변형한다.  
기하구조를 생성하거나 파괴할 수 있다.  
흔한 용도는 하나의 점이나 선분을 하나의 사각형으로 확장하는 것.  
출력 정점자료를 스트림 출력 단계를 통해 메모리의 버퍼에 저장해두고 나중에 활용 가능.
	
절단(clipping)
======
시야 절두체를 완전히 벗어난 기하구조는 폐기하고 절두체의 경계면과 교차하는 기하구조는 절두체 내부의 것만 남도록 잘라내는 것.  
- 절단 연산은 하드웨어가 수행해 준다.  
- 서덜런드-호지먼(Sutherland-Hodgeman) 절단 알고리즘을 참조.  
이 알고리즘은 평면과 다각형 변들의 교점을 구하고, 정점들을 다시 배열해 새로운 절단된 다각형을 형성한다. 책 참조 !!!! 

레스터화기 단계(rasterization stage)
======
투영된 3차원 삼각형으로부터 픽셀 색상들을 계산한다.
	
**뷰포트 변환** : NDC공간으로 들어온 정점들을 2차원 x,y좌표성분들을 후면 버퍼의 한 직사각형 영역(뷰포트)으로 변환. z성분은 변경하지 않는다.

**후면 선별(backface culling)**
- 하나의 삼각형에는 앞면과 뒷면이 있다. 관찰자가 삼각형의 앞쪽면을 보면 그 삼각형은 전면 삼각형이고 반대의 경우는 후면(back-facing) 삼각형이다. 
- Direct3D에서는 시계방향 삼각형을 전면으로 한다.
- 후면은 보이지 않기 때문에 그릴 필요가 없다.

**정점 특성의 보간** : 뷰포트 변환을 거친 후에는 정점의 특성들을 삼각형을 덮는 각 픽셀에 대해 보간해야 한다.
- 이를 위해 원근 보정 보간(perspective correct interpolation)이 필요하다.  
하드웨어가 수행한다.
- 3차원공간에서의 선형 보간을 위해서는 화면 공간에서 비선형 보간을 수행해야 한다.

- - -

픽셀 셰이더(pixel shader, PS) 단계
======
각각의 픽셀 단편(pixel fragment)마다 실행된다.  
보간된 정점특성들을 입력받아 하나의 색상을 출력한다.

- - -

출력 병합기(output merger, OM) 단계
======
픽셀 셰이더가 생성한 픽셀 단편들이 기각(폐기)되거나 후면 버퍼에 기록된다.  
혼합(blending, 두 픽셀을 일정한 공식에 따라 혼합한 결과를 기록)도 이 단계에서 일어난다.
